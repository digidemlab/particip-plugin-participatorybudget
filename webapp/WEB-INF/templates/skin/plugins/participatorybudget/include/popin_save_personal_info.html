<#-- required Jquery to work -->
<#macro addPopinSavePersonalInfo prefix="" >
<script type='text/javascript'>
var ${prefix}popinCallback;

function ${prefix}openPopinSavePersonalInfo( callback, onhide) {
	$("#gender").html( $('input[name=civility]:checked').parent().text() );
	$("#preferred_username").html( $("#budget-lastname").val( ) );
	$("#first_name").html( $("#budget-firstname").val( ) );
	$("#birthdate").html( $("#budget-birthdate").val( ) );
	$("#address").html( $("#budget-address").val( ) );
	
	$("#${prefix}popin-save-personal-info").modal('show');
	if(onhide) {
		$("#${prefix}popin-save-personal-info").on('hidden.bs.modal', onhide);
	}
	${prefix}popinCallback = callback;
}

function ${prefix}callPopinCallback(result) {
	if(${prefix}popinCallback) { ${prefix}popinCallback(result); }
}

$(document).on("click", "#${prefix}popin-save-personal-info-yes", function(event){
	$("#${prefix}popin-save-personal-info").modal('hide');
	${prefix}callPopinCallback(true);
});
$(document).on("click", "#${prefix}popin-save-personal-info-no", function(event){
	$("#${prefix}popin-save-personal-info").modal('hide');
	${prefix}callPopinCallback(false);
});

</script>

<div class="modal modal-static fade" id="${prefix}popin-save-personal-info" role="dialog" aria-hidden="true">
    <div class="modal-dialog" id="popin-save-personal-info-content">
       <div class="modal-content">
		  <div class="modal-header">
			<h3 class="modal-title" id="myModalLabel">#i18n{participatorybudget.savepersonaldata.popin.title}</h3>
		  </div>
		  <div class="modal-body">
			<div class="row">
				<div style="font-size:1.8rem" class="col-xs-12">
					#i18n{participatorybudget.savepersonaldata.popin.text}

					<#if ids_attributes?exists>
						<br/>
						<br/>
						<div class="responsive-table-line">
							<table>
								<thead>
									<tr>
										<th>#i18n{participatorybudget.savepersonaldata.popin.labelField}</th>
										<th>#i18n{participatorybudget.savepersonaldata.popin.labelBefore}</th>
										<th>#i18n{participatorybudget.savepersonaldata.popin.labelAfter}</th>
									</tr>
								</thead>
								<tbody>
										<#list ids_attributes?keys as label>
											<#assign attr=ids_attributes[label]>
											<tr>
												<td data-title="#i18n{participatorybudget.savepersonaldata.popin.labelField}">${label!'?'}&nbsp;:</td>
												<td data-title="#i18n{participatorybudget.savepersonaldata.popin.labelBefore}">${attr.value!'?'}&nbsp;</td>

												<#if attr.certified>
													<td data-title="#i18n{participatorybudget.savepersonaldata.popin.labelAfter}">#i18n{participatorybudget.mes_infos.certified}&nbsp;</td>
												<#else>
													<td id="${attr.key}" data-title="#i18n{participatorybudget.savepersonaldata.popin.labelAfter}"></td>
												</#if>
												
											</tr>
										</#list>
								</tbody>
							</table>
						</div>
					</#if>

				</div>
			</div>
			<p>&nbsp;</p>
			<div class="row">
				<div class="col-xs-6">
					<span id="${prefix}popin-save-personal-info-yes" class="btn btn-18rem btn-black-on-white" style="width:100%">#i18n{participatorybudget.savepersonaldata.popin.yes}</span>
				</div>
				<div class="col-xs-6">
					<span id="${prefix}popin-save-personal-info-no"  class="btn btn-18rem btn-black-on-white" style="width:100%">#i18n{participatorybudget.savepersonaldata.popin.no}</span>
				</div>
			</div>
		  </div>
	  </div>
	</div>
</div>

</#macro>